---
import {
  ArrowLeft,
  ArrowRight,
  Check,
  Globe,
  Palette,
  SendHorizontal,
  Server,
  Settings,
  ShoppingCart,
  Sparkles,
  TrendingUp,
  Wrench,
} from "@lucide/astro";
import Badge from "../../components/ui/Badge.astro";
import Button from "../../components/ui/Button.astro";
import Container from "../../components/ui/Container.astro";
import Section from "../../components/ui/Section.astro";
import Layout from "../../layouts/Layout.astro";

const services = [
  {
    label: "Website Design & Development",
    value: "website-design-development",
    description: "Custom websites built for performance and conversions.",
    icon: Globe,
  },
  {
    label: "SEO & Analytics",
    value: "seo-analytics",
    description: "Get found online and track your success.",
    icon: TrendingUp,
  },
  {
    label: "Brand & Logo Design",
    value: "brand-logo-design",
    description: "Create a memorable brand identiy.",
    icon: Palette,
  },
  {
    label: "E-Commerce Solutions",
    value: "ecommerce-solutions",
    description: "Sell your products online with secure, user-friendly stores.",
    icon: ShoppingCart,
  },
  {
    label: "Business Systems Setup",
    value: "business-systems-setup",
    description:
      "CRM, project management, accounting, and workflow automation.",
    icon: Settings,
  },
  {
    label: "Website Updates & Add-Ons",
    value: "website-updates-add-ons",
    description: "Ongoing updates, additional pages or new features.",
    icon: Wrench,
  },
];
---

<Layout
  title="Request Services | CoreLuminate"
  description="Tell us about your project and the services you need. We'll create a custom proposal tailored to your goals and budget.">
  <!-- Hero Section -->
  <Section
    background="dark"
    pattern={{ type: "grid", visibility: "light" }}
    size="sm">
    <Container>
      <div class="max-w-3xl mx-auto text-center">
        <Badge variant="white" class="mb-8">
          <Sparkles class="w-4 h-4" />
          <span>Get Started</span>
        </Badge>

        <h1
          class="text-5xl md:text-6xl font-bold text-white mb-6 leading-tight">
          Let's Build Your<br />
          <span
            class="text-transparent bg-clip-text bg-linear-to-r from-blue-400 to-cyan-400">
            Custom Solution
          </span>
        </h1>

        <p class="text-xl text-blue-100 leading-relaxed max-w-2xl mx-auto">
          Tell us what you need, and we'll create a tailored proposal with
          transparent pricing and clear timelines.
        </p>
      </div>
    </Container>
  </Section>

  <!-- Multi-Step Form Section -->
  <Section size="3xl" background="white">
    <Container>
      <div class="max-w-5xl mx-auto">
        <!-- Progress Bar -->
        <div class="mb-12">
          <div class="flex items-center justify-between mb-4">
            <div class="flex items-center gap-2">
              <div
                id="indicator-1"
                class="w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center transition-all">
                <span class="step-number font-semibold text-white text-sm"
                  >1</span
                >
              </div>
              <span
                id="label-1"
                class="text-sm font-medium text-slate-900 transition-colors"
                >Services</span
              >
            </div>

            <div
              id="line-1"
              class="flex-1 h-1 bg-slate-200 mx-4 transition-colors">
            </div>

            <div class="flex items-center gap-2">
              <div
                id="indicator-2"
                class="w-10 h-10 rounded-full bg-slate-200 flex items-center justify-center transition-all">
                <span class="step-number font-semibold text-slate-600 text-sm"
                  >2</span
                >
              </div>
              <span
                id="label-2"
                class="text-sm font-medium text-slate-400 transition-colors"
                >Details</span
              >
            </div>

            <div
              id="line-2"
              class="flex-1 h-1 bg-slate-200 mx-4 transition-colors">
            </div>

            <div class="flex items-center gap-2">
              <div
                id="indicator-3"
                class="w-10 h-10 rounded-full bg-slate-200 flex items-center justify-center transition-all">
                <span class="step-number font-semibold text-slate-600 text-sm"
                  >3</span
                >
              </div>
              <span
                id="label-3"
                class="text-sm font-medium text-slate-400 transition-colors"
                >Contact</span
              >
            </div>

            <div
              id="line-3"
              class="flex-1 h-1 bg-slate-200 mx-4 transition-colors">
            </div>

            <div class="flex items-center gap-2">
              <div
                id="indicator-4"
                class="w-10 h-10 rounded-full bg-slate-200 flex items-center justify-center transition-all">
                <span class="step-number font-semibold text-slate-600 text-sm"
                  >4</span
                >
              </div>
              <span
                id="label-4"
                class="text-sm font-medium text-slate-400 transition-colors"
                >Review</span
              >
            </div>
          </div>
        </div>

        <!-- Form Container -->
        <form id="service-request-form" class="space-y-8">
          <!-- Step 1: Service Selection -->
          <div id="step-1" class="form-step active">
            <div class="text-center mb-8">
              <h2 class="text-3xl font-bold text-slate-900 mb-3">
                Which services do you need?
              </h2>
              <p class="text-lg text-slate-600">
                Select all that apply. We'll build a custom package for you.
              </p>
            </div>

            <div class="grid md:grid-cols-2 gap-4">
              {
                services.map((service) => {
                  const Icon = service.icon;

                  return (
                    <label class="service-card flex flex-col relative cursor-pointer">
                      <input
                        type="checkbox"
                        name="services"
                        value={service.value}
                        class="service-checkbox absolute opacity-0 pointer-events-none"
                      />
                      <div class="service-card-content grow p-6 border-2 border-slate-200 rounded-2xl bg-white hover:border-blue-300 hover:shadow-sm">
                        <div class="flex items-start gap-4">
                          <div class="w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center shrink-0">
                            <Icon class="w-6 h-6 text-white" />
                          </div>
                          <div class="grow">
                            <h3 class="font-bold text-slate-900 mb-1">
                              {service.label}
                            </h3>
                            <p class="text-sm text-slate-600">
                              {service.description}
                            </p>
                          </div>
                          <div class="service-checkmark w-6 h-6 rounded-full bg-slate-200 flex items-center justify-center shrink-0 transition-all">
                            <Check class="w-5 h-5 text-white" />
                          </div>
                        </div>
                      </div>
                    </label>
                  );
                })
              }
            </div>
          </div>

          <!-- Step 2: Project Details -->
          <div id="step-2" class="form-step">
            <div class="text-center mb-8">
              <h2 class="text-3xl font-bold text-slate-900 mb-3">
                Tell us about your project
              </h2>
              <p class="text-lg text-slate-600">
                The more details you share, the better we can help.
              </p>
            </div>

            <div class="space-y-6 max-w-2xl mx-auto">
              <!-- Package Selection Display (if pre-selected) -->
              <div
                id="package-display"
                class="hidden bg-blue-50 rounded-xl p-4 border-2 border-blue-200">
                <p class="text-sm font-semibold text-slate-900 mb-1">
                  Selected Package:
                </p>
                <p id="package-name" class="text-blue-700 font-medium"></p>
                <input type="hidden" name="package" id="package-input" />
              </div>

              <!-- Managed Hosting Display (if pre-selected) -->
              <div id="managed-hosting-option-container" class="hidden">
                <h3 class="text-sm font-semibold text-slate-900 mb-2">
                  Recommended Add-On
                </h3>
                <label
                  class="service-card flex flex-col relative cursor-pointer">
                  <input
                    type="checkbox"
                    name="managedHosting"
                    value="true"
                    id="managed-hosting-checkbox"
                    class="service-checkbox absolute opacity-0 pointer-events-none"
                  />
                  <div
                    class="service-card-content grow p-6 border-2 border-slate-200 rounded-2xl bg-white hover:border-blue-300 hover:shadow-sm">
                    <div class="flex items-start gap-4">
                      <div
                        class="w-12 h-12 bg-emerald-500 rounded-xl flex items-center justify-center shrink-0">
                        <Server class="w-6 h-6 text-white" />
                      </div>
                      <div class="grow">
                        <h3 class="font-bold text-slate-900 mb-1">
                          Managed Hosting
                        </h3>
                        <p class="text-sm text-slate-600">
                          Secure, high-performance hosting with daily backups
                          and support.
                        </p>
                      </div>
                      <div class="flex flex-col items-end shrink-0">
                        <div
                          class="service-checkmark w-6 h-6 rounded-full bg-slate-200 flex items-center justify-center shrink-0 transition-all mb-1">
                          <Check class="w-5 h-5 text-white" />
                        </div>
                        <span class="text-sm font-bold text-emerald-600"
                          >$29 / mo</span
                        >
                      </div>
                    </div>
                  </div>
                </label>
              </div>

              <div>
                <label
                  for="project-description"
                  class="block text-sm font-semibold text-slate-900 mb-2">
                  Project Description *
                </label>
                <textarea
                  id="project-description"
                  name="description"
                  rows="6"
                  required
                  placeholder="Tell us about your business, goals, and what you're hoping to accomplish..."
                  class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-blue-500 transition-colors resize-none text-slate-900"
                ></textarea>
              </div>

              <div>
                <label
                  for="budget"
                  class="block text-sm font-semibold text-slate-900 mb-2">
                  Budget Range *
                </label>
                <select
                  id="budget"
                  name="budget"
                  required
                  class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-blue-500 transition-colors text-slate-900">
                  <option value="">Select your budget range</option>
                  <option value="under-1000">Under $1,000</option>
                  <option value="1000-2500">$1,000 - $2,500</option>
                  <option value="2500-5000">$2,500 - $5,000</option>
                  <option value="5000-10000">$5,000 - $10,000</option>
                  <option value="over-10000">$10,000+</option>
                  <option value="flexible">Flexible / Not Sure</option>
                </select>
              </div>

              <div>
                <label
                  for="timeline"
                  class="block text-sm font-semibold text-slate-900 mb-2">
                  Timeline *
                </label>
                <select
                  id="timeline"
                  name="timeline"
                  required
                  class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-blue-500 transition-colors text-slate-900">
                  <option value="">When do you need this completed?</option>
                  <option value="asap">As soon as possible</option>
                  <option value="1-3-months">1-3 months</option>
                  <option value="3-6-months">3-6 months</option>
                  <option value="6-plus-months">6+ months</option>
                  <option value="flexible">Flexible / Just exploring</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Step 3: Contact Information -->
          <div id="step-3" class="form-step">
            <div class="text-center mb-8">
              <h2 class="text-3xl font-bold text-slate-900 mb-3">
                How can we reach you?
              </h2>
              <p class="text-lg text-slate-600">
                We'll send you a custom proposal within 1-2 business days.
              </p>
            </div>

            <div class="space-y-6 max-w-2xl mx-auto">
              <div class="grid md:grid-cols-2 gap-6">
                <div>
                  <label
                    for="first-name"
                    class="block text-sm font-semibold text-slate-900 mb-2">
                    First Name *
                  </label>
                  <input
                    type="text"
                    id="first-name"
                    name="firstName"
                    required
                    placeholder="John"
                    class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-blue-500 transition-colors text-slate-900"
                  />
                </div>

                <div>
                  <label
                    for="last-name"
                    class="block text-sm font-semibold text-slate-900 mb-2">
                    Last Name *
                  </label>
                  <input
                    type="text"
                    id="last-name"
                    name="lastName"
                    required
                    placeholder="Doe"
                    class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-blue-500 transition-colors text-slate-900"
                  />
                </div>
              </div>

              <div>
                <label
                  for="email"
                  class="block text-sm font-semibold text-slate-900 mb-2">
                  Email Address *
                </label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  required
                  placeholder="john@example.com"
                  class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-blue-500 transition-colors text-slate-900"
                />
              </div>

              <div>
                <label
                  for="phone"
                  class="block text-sm font-semibold text-slate-900 mb-2">
                  Phone Number
                </label>
                <input
                  type="tel"
                  id="phone"
                  name="phone"
                  placeholder="(555) 123-4567"
                  class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-blue-500 transition-colors text-slate-900"
                />
              </div>

              <div>
                <label
                  for="company"
                  class="block text-sm font-semibold text-slate-900 mb-2">
                  Company Name
                </label>
                <input
                  type="text"
                  id="company"
                  name="company"
                  placeholder="Acme Inc."
                  class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-blue-500 transition-colors text-slate-900"
                />
              </div>

              <div>
                <label
                  for="hear-about"
                  class="block text-sm font-semibold text-slate-900 mb-2">
                  How did you hear about us?
                </label>
                <select
                  id="hear-about"
                  name="hearAbout"
                  class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-blue-500 transition-colors text-slate-900">
                  <option value="">Select an option</option>
                  <option value="google">Google Search</option>
                  <option value="social-media">Social Media</option>
                  <option value="referral">Referral</option>
                  <option value="previous-client">Previous Client</option>
                  <option value="other">Other</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Step 4: Review -->
          <div id="step-4" class="form-step">
            <div class="text-center mb-8">
              <h2 class="text-3xl font-bold text-slate-900 mb-3">
                Review your request
              </h2>
              <p class="text-lg text-slate-600">
                Make sure everything looks good before submitting.
              </p>
            </div>

            <div class="max-w-2xl mx-auto space-y-6">
              <!-- Selected Services Review -->
              <div
                class="bg-slate-50 rounded-2xl p-6 border-2 border-slate-200">
                <h3
                  class="font-bold text-slate-900 mb-4 flex items-center gap-4">
                  <div
                    class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                    <Check class="w-4 h-4 text-blue-600" />
                  </div>
                  Selected Services
                </h3>
                <div id="review-services" class="space-y-2">
                  <!-- Populated by JavaScript -->
                </div>
              </div>

              <!-- Project Details Review -->
              <div
                class="bg-slate-50 rounded-2xl p-6 border-2 border-slate-200">
                <h3 class="font-bold text-slate-900 mb-4">Project Details</h3>
                <div class="space-y-3 text-sm">
                  <div>
                    <span class="font-semibold text-slate-700"
                      >Description:</span
                    >
                    <p class="text-slate-600 mt-1" id="review-description"></p>
                  </div>
                  <div class="grid md:grid-cols-2 gap-4">
                    <div>
                      <span class="font-semibold text-slate-700">Budget:</span>
                      <p class="text-slate-600 mt-1" id="review-budget"></p>
                    </div>
                    <div>
                      <span class="font-semibold text-slate-700">Timeline:</span
                      >
                      <p class="text-slate-600 mt-1" id="review-timeline"></p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Contact Info Review -->
              <div
                class="bg-slate-50 rounded-2xl p-6 border-2 border-slate-200">
                <h3 class="font-bold text-slate-900 mb-4">
                  Contact Information
                </h3>
                <div class="space-y-2 text-sm">
                  <div class="flex justify-between">
                    <span class="font-semibold text-slate-700">Name:</span>
                    <span class="text-slate-600" id="review-name"></span>
                  </div>
                  <div class="flex justify-between">
                    <span class="font-semibold text-slate-700">Email:</span>
                    <span class="text-slate-600" id="review-email"></span>
                  </div>
                  <div class="flex justify-between" id="review-phone-container">
                    <span class="font-semibold text-slate-700">Phone:</span>
                    <span class="text-slate-600" id="review-phone"></span>
                  </div>
                  <div
                    class="flex justify-between"
                    id="review-company-container">
                    <span class="font-semibold text-slate-700">Company:</span>
                    <span class="text-slate-600" id="review-company"></span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Form Messages Display -->
          <div
            id="service-toast"
            class="text-center mt-8 px-8 py-4 rounded-xl hidden">
            <p class="text-sm" id="service-message">
              Please make at least one service selection.
            </p>
          </div>

          <!-- Navigation Buttons -->
          <div class="flex justify-between items-center pt-8">
            <Button
              type="button"
              id="prev-btn"
              variant="secondary"
              class="hidden"
              icon={ArrowLeft}
              iconPosition="left">
              Back
            </Button>

            <div class="grow"></div>

            <Button type="button" id="next-btn" icon={ArrowRight}>
              Continue
            </Button>

            <Button
              type="submit"
              id="submit-btn"
              class="hidden"
              icon={SendHorizontal}>
              Submit Request
            </Button>
          </div>
        </form>
      </div>
    </Container>
  </Section>
</Layout>

<style>
  /* Minimal custom CSS - only what Tailwind can't handle */

  /* Form step visibility */
  .form-step {
    display: none;
  }

  .form-step.active {
    display: block;
  }
</style>

<script src="../../scripts/forms/service-request/index.ts"></script>
