---
interface Props {
  type?:
    | "dots"
    | "grid"
    | "diagonal"
    | "plus"
    | "hexagons"
    | "circuit"
    | "triangles"
    | "waves"
    | "zigzag"
    | "crosses"
    | "squares"
    | "circles"
    | "stars"
    | "mesh"
    | "topography";
  opacity?: number;
  color?: string;
  class?: string;
}

const {
  type = "dots",
  opacity = 0.05,
  color = "text-slate-900",
  class: className = "",
} = Astro.props;

// Generate unique ID to avoid conflicts when multiple patterns on same page
const patternId = `pattern-${type}-${Math.random().toString(36).substr(2, 9)}`;

const patterns = {
  dots: `
    <pattern id="${patternId}" width="40" height="40" patternUnits="userSpaceOnUse">
      <circle cx="2" cy="2" r="1" fill="currentColor"/>
    </pattern>
  `,
  grid: `
    <pattern id="${patternId}" width="60" height="60" patternUnits="userSpaceOnUse">
      <path d="M 60 0 L 0 0 0 60" fill="none" stroke="currentColor" stroke-width="0.5"/>
    </pattern>
  `,
  diagonal: `
    <pattern id="${patternId}" width="10" height="10" patternUnits="userSpaceOnUse" patternTransform="rotate(45)">
      <line x1="0" y1="0" x2="0" y2="10" stroke="currentColor" stroke-width="0.5"/>
    </pattern>
  `,
  plus: `
    <pattern id="${patternId}" width="30" height="30" patternUnits="userSpaceOnUse">
      <path d="M15 5 L15 25 M5 15 L25 15" stroke="currentColor" stroke-width="1"/>
    </pattern>
  `,
  hexagons: `
    <pattern id="${patternId}" width="56" height="100" patternUnits="userSpaceOnUse">
      <path d="M28 66L0 50L0 16L28 0L56 16L56 50L28 66L28 100" fill="none" stroke="currentColor" stroke-width="0.5"/>
      <path d="M28 0L28 34L0 50L0 84L28 100L56 84L56 50L28 34" fill="none" stroke="currentColor" stroke-width="0.5"/>
    </pattern>
  `,
  circuit: `
    <pattern id="${patternId}" width="50" height="50" patternUnits="userSpaceOnUse">
      <circle cx="5" cy="5" r="2" fill="currentColor"/>
      <circle cx="45" cy="45" r="2" fill="currentColor"/>
      <path d="M5 5 L25 5 L25 25 M25 25 L45 25 L45 45" stroke="currentColor" stroke-width="0.5" fill="none"/>
    </pattern>
  `,
  triangles: `
    <pattern id="${patternId}" width="40" height="40" patternUnits="userSpaceOnUse">
      <path d="M0 40 L20 0 L40 40 Z" fill="none" stroke="currentColor" stroke-width="0.5"/>
    </pattern>
  `,
  waves: `
    <pattern id="${patternId}" width="60" height="20" patternUnits="userSpaceOnUse">
      <path d="M0 10 Q15 0, 30 10 T60 10" fill="none" stroke="currentColor" stroke-width="0.5"/>
    </pattern>
  `,
  zigzag: `
    <pattern id="${patternId}" width="40" height="20" patternUnits="userSpaceOnUse">
      <path d="M0 20 L10 0 L20 20 L30 0 L40 20" fill="none" stroke="currentColor" stroke-width="0.5"/>
    </pattern>
  `,
  crosses: `
    <pattern id="${patternId}" width="30" height="30" patternUnits="userSpaceOnUse">
      <path d="M10 5 L10 25 M5 15 L15 15" stroke="currentColor" stroke-width="1"/>
      <path d="M25 20 L25 30 M20 25 L30 25" stroke="currentColor" stroke-width="1"/>
    </pattern>
  `,
  squares: `
    <pattern id="${patternId}" width="80" height="80" patternUnits="userSpaceOnUse">
      <rect x="5" y="5" width="60" height="60" fill="none" stroke="currentColor" stroke-width="0.5"/>
      <rect x="25" y="25" width="60" height="60" fill="none" stroke="currentColor" stroke-width="0.5"/>
    </pattern>
  `,
  circles: `
    <pattern id="${patternId}" width="50" height="50" patternUnits="userSpaceOnUse">
      <circle cx="20" cy="20" r="5" fill="none" stroke="currentColor" stroke-width="0.5"/>
      <circle cx="40" cy="40" r="5" fill="none" stroke="currentColor" stroke-width="0.5"/>
    </pattern>
  `,
  stars: `
    <pattern id="${patternId}" width="80" height="80" patternUnits="userSpaceOnUse">
      <path d="M25 10 L27 20 L37 20 L29 26 L32 36 L25 30 L18 36 L21 26 L13 20 L23 20 Z" fill="none" stroke="currentColor" stroke-width="0.5"/>
    </pattern>
  `,
  mesh: `
    <pattern id="${patternId}" width="60" height="60" patternUnits="userSpaceOnUse">
      <path d="M0 30 L30 0 M30 60 L60 30 M0 60 L30 30 L60 60 M0 0 L30 30 L60 0" fill="none" stroke="currentColor" stroke-width="0.5"/>
    </pattern>
  `,
  topography: `
    <pattern id="${patternId}" width="100" height="100" patternUnits="userSpaceOnUse">
      <path d="M10 50 Q25 30, 40 50 T70 50 T100 50" fill="none" stroke="currentColor" stroke-width="0.5"/>
      <path d="M0 70 Q20 55, 40 70 T80 70 T100 70" fill="none" stroke="currentColor" stroke-width="0.5"/>
      <path d="M10 30 Q30 15, 50 30 T90 30" fill="none" stroke="currentColor" stroke-width="0.5"/>
    </pattern>
  `,
};
---

<div
  class={`absolute inset-0 pointer-events-none ${className}`}
  style={`opacity: ${opacity}`}>
  <svg class={`w-full h-full ${color}`} xmlns="http://www.w3.org/2000/svg">
    <defs set:html={patterns[type]} />
    <rect width="100%" height="100%" fill={`url(#${patternId})`}></rect>
  </svg>
</div>
