---
import { ArrowRight, Calendar, Clock } from "@lucide/astro";
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";
import { formatDate } from "../../lib/helpers";

interface Props {
  post: CollectionEntry<"blog">;
}

const { post } = Astro.props;
---

<article
  class="group flex flex-col bg-white border border-slate-200 rounded-2xl overflow-hidden shadow-sm hover:shadow-md hover:border-blue-200 transition-all duration-300">
  <!-- Featured Image -->
  {
    post.data.featuredImage && (
      <a href={`/blog/${post.slug}`} class="block overflow-hidden aspect-video">
        <Image
          src={post.data.featuredImage.url}
          alt={
            post.data.featuredImage.alt === undefined
              ? post.data.title
              : post.data.featuredImage.alt
          }
          class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
          widths={[400, 600]}
          sizes="(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 33vw"
          quality={85}
        />
      </a>
    )
  }

  <!-- Content -->
  <div class="flex flex-col flex-1 p-6">
    <!-- Meta Info -->
    <div class="flex flex-wrap items-center gap-4 mb-4">
      {
        post.data.categories.length > 0 && (
          <a
            href={`/blog/category/${post.data.categories[0].toLowerCase().replace(/\s+/g, "-")}`}
            class="text-xs font-semibold text-slate-600 hover:text-blue-700 uppercase tracking-wide">
            {post.data.categories[0]}
          </a>
        )
      }
      <div class="flex items-center gap-2 text-xs text-slate-500">
        <Calendar class="w-3 h-3" />
        <time datetime={post.data.publishDate.toISOString()}>
          {formatDate(post.data.publishDate, "short")}
        </time>
      </div>
      {
        post.data.readTime && (
          <div class="flex items-center gap-2 text-xs text-slate-500">
            <Clock class="w-3 h-3" />
            <span>{post.data.readTime}</span>
          </div>
        )
      }
    </div>

    <!-- Title -->
    <h3
      class="text-xl font-bold text-slate-900 mb-3 group-hover:text-blue-600 transition-colors">
      <a href={`/blog/${post.slug}`} class="hover:underline">
        {post.data.title}
      </a>
    </h3>

    <!-- Description -->
    <p class="text-slate-600 mb-4 line-clamp-3 flex-1">
      {post.data.description}
    </p>

    <!-- Read More Link -->
    <a
      href={`/blog/${post.slug}`}
      class="inline-flex items-center gap-2 text-sm font-semibold text-blue-600 hover:text-blue-700 group/link">
      Read More
      <ArrowRight
        class="w-4 h-4 group-hover/link:translate-x-1 transition-transform"
      />
    </a>
  </div>
</article>
